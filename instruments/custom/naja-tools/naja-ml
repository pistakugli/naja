#!/usr/bin/env python3
import sys, os
sys.path.insert(0, '/mnt/user-data/python-packages')
import torch
import torch.nn as nn

class SimpleMLP(nn.Module):
    def __init__(self, input_dim=42, hidden_dim=128, output_dim=8):
        super().__init__()
        self.net = nn.Sequential(
            nn.Linear(input_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, output_dim)
        )
    
    def forward(self, x):
        return self.net(x)

def main():
    if len(sys.argv) < 2:
        print("Usage: naja-ml <train|test|info>")
        sys.exit(1)
    
    cmd = sys.argv[1]
    
    if cmd == 'info':
        print(f"PyTorch: {torch.__version__}")
        print(f"CUDA available: {torch.cuda.is_available()}")
        print(f"Device: {'cuda' if torch.cuda.is_available() else 'cpu'}")
    
    elif cmd == 'test':
        model = SimpleMLP()
        x = torch.randn(1, 42)
        y = model(x)
        print(f"âœ… Model test successful")
        print(f"Input shape: {x.shape}")
        print(f"Output shape: {y.shape}")
        print(f"Output: {y.detach().numpy()}")

if __name__ == "__main__":
    main()
